<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1653px" preserveAspectRatio="none" style="width:1289px;height:1653px;" version="1.1" viewBox="0 0 1289 1653" width="1289px" zoomAndPan="magnify"><defs><filter height="300%" id="fzl3l01phdx8h" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="320" x="481.25" y="30.6855">Диаграмма последовательности Psec</text><rect fill="#DDDDDD" height="1605.1094" style="stroke:#A80036;stroke-width:1.0;" width="381" x="198" y="42.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="73" x="352" y="56.1357">Mail Server</text><rect fill="#FFFFFF" filter="url(#fzl3l01phdx8h)" height="1271.2656" style="stroke:#000000;stroke-width:2.0;" width="1197.5" x="75" y="254.2656"/><rect fill="#FFFFFF" filter="url(#fzl3l01phdx8h)" height="1208.5625" style="stroke:#000000;stroke-width:2.0;" width="1177.5" x="85" y="309.9688"/><rect fill="#FFFFFF" filter="url(#fzl3l01phdx8h)" height="863.0234" style="stroke:#000000;stroke-width:2.0;" width="1070.5" x="182" y="556.1328"/><rect fill="#ADD8E6" filter="url(#fzl3l01phdx8h)" height="338.6953" style="stroke:#000000;stroke-width:2.0;" width="528.5" x="192" y="984.4063"/><rect fill="#ADD8E6" height="46.1875" style="stroke:none;stroke-width:1.0;" width="528.5" x="192" y="1092.1641"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="528.5" x="192" y="1138.3516"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="528.5" x="192" y="1184.5391"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="528.5" x="192" y="1230.7266"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="528.5" x="192" y="1276.9141"/><rect fill="#FFC0CB" filter="url(#fzl3l01phdx8h)" height="75.0547" style="stroke:#000000;stroke-width:2.0;" width="564.5" x="192" y="1337.1016"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="1177.5" x="85" y="1426.1563"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="1177.5" x="85" y="1472.3438"/><line style="stroke:#A80036;stroke-width:1.0;" x1="54" x2="54" y1="143.8594" y2="665.5391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="54" x2="54" y1="665.5391" y2="693.5391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="54" x2="54" y1="693.5391" y2="1542.5313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283" x2="283" y1="143.8594" y2="665.5391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="283" x2="283" y1="665.5391" y2="693.5391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283" x2="283" y1="693.5391" y2="1542.5313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="515" x2="515" y1="143.8594" y2="665.5391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="515" x2="515" y1="665.5391" y2="693.5391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="515" x2="515" y1="693.5391" y2="1542.5313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="632" x2="632" y1="143.8594" y2="665.5391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="632" x2="632" y1="665.5391" y2="693.5391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="632" x2="632" y1="693.5391" y2="1542.5313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="868.5" x2="868.5" y1="143.8594" y2="665.5391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="868.5" x2="868.5" y1="665.5391" y2="693.5391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="868.5" x2="868.5" y1="693.5391" y2="1542.5313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1015" x2="1015" y1="143.8594" y2="665.5391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1015" x2="1015" y1="665.5391" y2="693.5391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1015" x2="1015" y1="693.5391" y2="1542.5313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1160" x2="1160" y1="143.8594" y2="665.5391"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1160" x2="1160" y1="665.5391" y2="693.5391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1160" x2="1160" y1="693.5391" y2="1542.5313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="5" y="140.7832">Сотрудник ИБ</text><ellipse cx="54.5" cy="69.25" fill="#FEFECE" filter="url(#fzl3l01phdx8h)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M54.5,77.25 L54.5,104.25 M41.5,85.25 L67.5,85.25 M54.5,104.25 L41.5,119.25 M54.5,104.25 L67.5,119.25 " fill="none" filter="url(#fzl3l01phdx8h)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="5" y="1556.0645">Сотрудник ИБ</text><ellipse cx="54.5" cy="1569.1406" fill="#FEFECE" filter="url(#fzl3l01phdx8h)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M54.5,1577.1406 L54.5,1604.1406 M41.5,1585.1406 L67.5,1585.1406 M54.5,1604.1406 L41.5,1619.1406 M54.5,1604.1406 L67.5,1619.1406 " fill="none" filter="url(#fzl3l01phdx8h)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#fzl3l01phdx8h)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="159" x="202" y="89.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="231" y="111.1738">Почтовый ящик</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145" x="209" y="128.7832">администратора сети</text><rect fill="#FEFECE" filter="url(#fzl3l01phdx8h)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="159" x="202" y="1541.5313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="231" y="1563.0645">Почтовый ящик</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="145" x="209" y="1580.6738">администратора сети</text><rect fill="#FEFECE" filter="url(#fzl3l01phdx8h)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="115" x="456" y="89.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="463" y="111.1738">Почтовый ящик</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="498" y="128.7832">Psec</text><rect fill="#FEFECE" filter="url(#fzl3l01phdx8h)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="115" x="456" y="1541.5313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="463" y="1563.0645">Почтовый ящик</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="498" y="1580.6738">Psec</text><rect fill="#FEFECE" filter="url(#fzl3l01phdx8h)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="91" x="585" y="107.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="592" y="128.7832">Psec Server</text><rect fill="#FEFECE" filter="url(#fzl3l01phdx8h)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="91" x="585" y="1541.5313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="592" y="1563.0645">Psec Server</text><rect fill="#FEFECE" filter="url(#fzl3l01phdx8h)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="84" x="824.5" y="107.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="831.5" y="128.7832">Log Server</text><rect fill="#FEFECE" filter="url(#fzl3l01phdx8h)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="84" x="824.5" y="1541.5313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="831.5" y="1563.0645">Log Server</text><rect fill="#FEFECE" filter="url(#fzl3l01phdx8h)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="95" x="966" y="89.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="973" y="111.1738">Коммутатор</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="987" y="128.7832">доступа</text><rect fill="#FEFECE" filter="url(#fzl3l01phdx8h)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="95" x="966" y="1541.5313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="973" y="1563.0645">Коммутатор</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53" x="987" y="1580.6738">доступа</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="1119.5" y="123.1738">Системный</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="1106" y="140.7832">администратор</text><ellipse cx="1160.5" cy="51.6406" fill="#FEFECE" filter="url(#fzl3l01phdx8h)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1160.5,59.6406 L1160.5,86.6406 M1147.5,67.6406 L1173.5,67.6406 M1160.5,86.6406 L1147.5,101.6406 M1160.5,86.6406 L1173.5,101.6406 " fill="none" filter="url(#fzl3l01phdx8h)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76" x="1119.5" y="1556.0645">Системный</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="103" x="1106" y="1573.6738">администратор</text><ellipse cx="1160.5" cy="1586.75" fill="#FEFECE" filter="url(#fzl3l01phdx8h)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1160.5,1594.75 L1160.5,1621.75 M1147.5,1602.75 L1173.5,1602.75 M1160.5,1621.75 L1147.5,1636.75 M1160.5,1621.75 L1173.5,1636.75 " fill="none" filter="url(#fzl3l01phdx8h)" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="271.5,188.5625,281.5,192.5625,271.5,196.5625,275.5,192.5625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="54.5" x2="277.5" y1="192.5625" y2="192.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="61.5" y="179.5303">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="72.5" y="171.3545">Сообщение с заявкой на</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="72.5" y="187.7061">подключение нового устройства</text><polygon fill="#A80036" points="503.5,235.2656,513.5,239.2656,503.5,243.2656,507.5,239.2656" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="509.5" y1="239.2656" y2="239.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="290.5" y="226.2334">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="301.5" y="218.0576">Форвардинг сообщения</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="301.5" y="234.4092">с заявкой</text><path d="M75,254.2656 L148,254.2656 L148,262.2656 L138,272.2656 L75,272.2656 L75,254.2656 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="1271.2656" style="stroke:#000000;stroke-width:2.0;" width="1197.5" x="75" y="254.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="90" y="268.7607">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="364" x="163" y="267.6846">[Проверка на наличие входящих сообщений (два раза в минуту)]</text><polygon fill="#FF0000" points="526.5,290.9688,516.5,294.9688,526.5,298.9688,522.5,294.9688" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="620.5,290.9688,630.5,294.9688,620.5,298.9688,624.5,294.9688" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="520.5" x2="626.5" y1="294.9688" y2="294.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="532.5" y="290.1123">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="543.5" y="290.1123">POP3</text><path d="M85,309.9688 L146,309.9688 L146,317.9688 L136,327.9688 L85,327.9688 L85,309.9688 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="1208.5625" style="stroke:#000000;stroke-width:2.0;" width="1177.5" x="85" y="309.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="100" y="324.4639">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="129" x="161" y="323.3877">[Проверка сообщения]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="632.5" x2="674.5" y1="373.6992" y2="373.6992"/><line style="stroke:#A80036;stroke-width:1.0;" x1="674.5" x2="674.5" y1="373.6992" y2="386.6992"/><line style="stroke:#A80036;stroke-width:1.0;" x1="633.5" x2="674.5" y1="386.6992" y2="386.6992"/><polygon fill="#A80036" points="643.5,382.6992,633.5,386.6992,643.5,390.6992,639.5,386.6992" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="639.5" y="360.667">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="650.5" y="352.4912">Создание дочернего процесса</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="650.5" y="368.8428">для выполнение одной заявки</text><path d="M463,333.3203 L463,392.3203 L623,392.3203 L623,343.3203 L613,333.3203 L463,333.3203 " fill="#FBFB77" filter="url(#fzl3l01phdx8h)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M613,333.3203 L613,343.3203 L623,343.3203 L613,333.3203 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="469" y="351.8154">Трек-идентификатор</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="469" y="368.167">заявки содержит</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="469" y="384.5186">MAC-адрес устройства</text><polygon fill="#FF0000" points="526.5,419.7266,516.5,423.7266,526.5,427.7266,522.5,423.7266" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="620.5,419.7266,630.5,423.7266,620.5,427.7266,624.5,423.7266" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="520.5" x2="626.5" y1="423.7266" y2="423.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="532.5" y="418.8701">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="543.5" y="418.8701">SMTP</text><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="475.4297" y2="471.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="475.4297" y2="479.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="514.5" y1="475.4297" y2="475.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="300.5" y="470.5732">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="311.5" y="470.5732">Заявка принята в обработку</text><path d="M95,436.7266 L95,495.7266 L274,495.7266 L274,446.7266 L264,436.7266 L95,436.7266 " fill="#FBFB77" filter="url(#fzl3l01phdx8h)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M264,436.7266 L264,446.7266 L274,446.7266 L264,436.7266 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="101" y="455.2217">"«MAC-адрес устройства»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="101" y="471.5732">принят в обработку"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="101" y="487.9248">в теме сообщения</text><rect fill="#EEEEEE" filter="url(#fzl3l01phdx8h)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1282.5" x="0" y="525.957"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1282.5" y1="525.957" y2="525.957"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1282.5" y1="528.957" y2="528.957"/><rect fill="#EEEEEE" filter="url(#fzl3l01phdx8h)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="196" x="543.25" y="514.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178" x="549.25" y="532.2764">Выполнение одной заявки</text><path d="M182,556.1328 L255,556.1328 L255,564.1328 L245,574.1328 L182,574.1328 L182,556.1328 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="863.0234" style="stroke:#000000;stroke-width:2.0;" width="1070.5" x="182" y="556.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="197" y="570.6279">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="230" x="270" y="569.5518">[Запрос к БД лог-сервера (раз в минуту)]</text><polygon fill="#0000FF" points="643.5,614.1875,633.5,618.1875,643.5,622.1875,639.5,618.1875" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="856.5,614.1875,866.5,618.1875,856.5,622.1875,860.5,618.1875" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="637.5" x2="862.5" y1="618.1875" y2="618.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="649.5" y="605.1553">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="660.5" y="596.9795">SSH подключение к лог-серверу,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="660.5" y="613.3311">запрос к БД Syslog (netmiko)</text><path d="M394,579.4844 L394,621.4844 L623,621.4844 L623,589.4844 L613,579.4844 L394,579.4844 " fill="#FBFB77" filter="url(#fzl3l01phdx8h)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M613,579.4844 L613,589.4844 L623,589.4844 L613,579.4844 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="400" y="597.9795">Запрос содержит MAC-адрес</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="400" y="614.3311">нового подключаемого устройства</text><polygon fill="#FBFB77" filter="url(#fzl3l01phdx8h)" points="599,636.1875,901,636.1875,911,648.1875,901,660.1875,599,660.1875,589,648.1875,599,636.1875" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="642.25" y="653.6826">Ожидание подключения устройства</text><polygon fill="#A80036" points="1026.5,728.2422,1016.5,732.2422,1026.5,736.2422,1022.5,732.2422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1020.5" x2="1159.5" y1="732.2422" y2="732.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="1032.5" y="719.21">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="1043.5" y="711.0342">Подключение</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="1043.5" y="727.3857">нового устройства</text><line style="stroke:#A80036;stroke-width:1.0;" x1="868.5" x2="878.5" y1="775.7695" y2="771.7695"/><line style="stroke:#A80036;stroke-width:1.0;" x1="868.5" x2="878.5" y1="775.7695" y2="779.7695"/><line style="stroke:#A80036;stroke-width:1.0;" x1="868.5" x2="1014.5" y1="775.7695" y2="775.7695"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="885.5" y="770.9131">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="896.5" y="770.9131">Syslog сообщение</text><path d="M1020,745.2422 L1020,787.2422 L1233,787.2422 L1233,755.2422 L1223,745.2422 L1020,745.2422 " fill="#FBFB77" filter="url(#fzl3l01phdx8h)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1223,745.2422 L1223,755.2422 L1233,755.2422 L1223,745.2422 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="1026" y="763.7373">Сообщение</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="1026" y="780.0889">информационной безопастности</text><polygon fill="#A80036" points="643.5,815.2969,633.5,819.2969,643.5,823.2969,639.5,819.2969" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="637.5" x2="867.5" y1="819.2969" y2="819.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="649.5" y="814.4404">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148" x="667.5" y="814.4404">Ответ от БД лог-сервера</text><line style="stroke:#A80036;stroke-width:1.0;" x1="632.5" x2="674.5" y1="864.5" y2="864.5"/><line style="stroke:#A80036;stroke-width:1.0;" x1="674.5" x2="674.5" y1="864.5" y2="877.5"/><line style="stroke:#A80036;stroke-width:1.0;" x1="633.5" x2="674.5" y1="877.5" y2="877.5"/><polygon fill="#A80036" points="643.5,873.5,633.5,877.5,643.5,881.5,639.5,877.5" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="639.5" y="859.6436">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="657.5" y="859.6436">Парсинг syslog сообщения</text><path d="M321,832.2969 L321,891.2969 L623,891.2969 L623,842.2969 L613,832.2969 L321,832.2969 " fill="#FBFB77" filter="url(#fzl3l01phdx8h)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M613,832.2969 L613,842.2969 L623,842.2969 L613,832.2969 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="327" y="850.792">Для дальнейшей настройки необходимы</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="327" y="867.1436">ip-адрес коммутатора доступа,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281" x="327" y="883.4951">порт к которому подключено новое устройство</text><polygon fill="#0000FF" points="643.5,935.0547,633.5,939.0547,643.5,943.0547,639.5,939.0547" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="1003.5,935.0547,1013.5,939.0547,1003.5,943.0547,1007.5,939.0547" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="637.5" x2="1009.5" y1="939.0547" y2="939.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="649.5" y="926.0225">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257" x="667.5" y="917.8467">SSH подключение к коммутатору доступа,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="667.5" y="934.1982">выполнение насторек (netmiko)</text><polygon fill="#FF0000" points="526.5,965.4063,516.5,969.4063,526.5,973.4063,522.5,969.4063" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="620.5,965.4063,630.5,969.4063,620.5,973.4063,624.5,969.4063" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="520.5" x2="626.5" y1="969.4063" y2="969.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="532.5" y="964.5498">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="550.5" y="964.5498">SMTP</text><path d="M192,984.4063 L253,984.4063 L253,992.4063 L243,1002.4063 L192,1002.4063 L192,984.4063 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="338.6953" style="stroke:#000000;stroke-width:2.0;" width="528.5" x="192" y="984.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="207" y="998.9014">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="229" x="268" y="997.8252">[Сообщение с результатом выполнения]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1054.6367" y2="1050.6367"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1054.6367" y2="1058.6367"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="514.5" y1="1054.6367" y2="1054.6367"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="300.5" y="1049.7803">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="318.5" y="1049.7803">Заявка выполнена</text><path d="M520,1007.7578 L520,1082.7578 L701,1082.7578 L701,1017.7578 L691,1007.7578 L520,1007.7578 " fill="#FBFB77" filter="url(#fzl3l01phdx8h)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M691,1007.7578 L691,1017.7578 L701,1017.7578 L691,1007.7578 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="526" y="1026.2529">Статус выполнения заявки</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="526" y="1042.6045">в теме сообщения,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="526" y="1058.9561">лог выполнения</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="526" y="1075.3076">заявки в теле сообщения</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="192" x2="720.5" y1="1093.1641" y2="1093.1641"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="173" x="197" y="1104.583">[Настройки выполнены ранее]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1130.3516" y2="1126.3516"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1130.3516" y2="1134.3516"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="514.5" y1="1130.3516" y2="1130.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="300.5" y="1125.4951">14.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="329.5" y="1125.4951">Заявка выполнена</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="192" x2="720.5" y1="1139.3516" y2="1139.3516"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="204" x="197" y="1150.7705">[Устройство в списке исключенных]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1176.5391" y2="1172.5391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1176.5391" y2="1180.5391"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="514.5" y1="1176.5391" y2="1176.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="300.5" y="1171.6826">14.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="329.5" y="1171.6826">Заявка не выполнена</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="192" x2="720.5" y1="1185.5391" y2="1185.5391"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="259" x="197" y="1196.958">[Попытка подключения устройства через Hub]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1222.7266" y2="1218.7266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1222.7266" y2="1226.7266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="514.5" y1="1222.7266" y2="1222.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="300.5" y="1217.8701">14.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="329.5" y="1217.8701">Заявка не выполнена</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="192" x2="720.5" y1="1231.7266" y2="1231.7266"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="212" x="197" y="1243.1455">[Порт доступа в состоянии shutdown]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1268.9141" y2="1264.9141"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1268.9141" y2="1272.9141"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="514.5" y1="1268.9141" y2="1268.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="300.5" y="1264.0576">14.4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="329.5" y="1264.0576">Заявка не выполнена</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="192" x2="720.5" y1="1277.9141" y2="1277.9141"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="129" x="197" y="1289.333">[Не удалось настроить]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1315.1016" y2="1311.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1315.1016" y2="1319.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="514.5" y1="1315.1016" y2="1315.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="300.5" y="1310.2451">14.5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="329.5" y="1310.2451">Заявка не выполнена</text><path d="M192,1337.1016 L273,1337.1016 L273,1345.1016 L263,1355.1016 L192,1355.1016 L192,1337.1016 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="75.0547" style="stroke:#000000;stroke-width:2.0;" width="564.5" x="192" y="1337.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="207" y="1351.5967">break</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="222" x="288" y="1350.5205">[Окончание рабочего дня (после 18:00)]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1390.9805" y2="1386.9805"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1390.9805" y2="1394.9805"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="514.5" y1="1390.9805" y2="1390.9805"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="300.5" y="1386.124">7.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="322.5" y="1386.124">Заявка не выполнена</text><path d="M520,1360.4531 L520,1402.4531 L737,1402.4531 L737,1370.4531 L727,1360.4531 L520,1360.4531 " fill="#FBFB77" filter="url(#fzl3l01phdx8h)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M727,1360.4531 L727,1370.4531 L737,1370.4531 L727,1360.4531 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="526" y="1378.9482">Устройство не было подключено</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="526" y="1395.2998">в течение дня</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="85" x2="1262.5" y1="1427.1563" y2="1427.1563"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="224" x="90" y="1438.5752">[Заявка поступила не от сотрудника ИБ]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1464.3438" y2="1460.3438"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1464.3438" y2="1468.3438"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="514.5" y1="1464.3438" y2="1464.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="300.5" y="1459.4873">6.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="322.5" y="1459.4873">Заявка не принята в обработку</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="85" x2="1262.5" y1="1473.3438" y2="1473.3438"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="366" x="90" y="1484.7627">[В теле письма отсутствует MAC-адрес (либо их слишком много)]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1510.5313" y2="1506.5313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="293.5" y1="1510.5313" y2="1514.5313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="283.5" x2="514.5" y1="1510.5313" y2="1510.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="300.5" y="1505.6748">6.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="322.5" y="1505.6748">Заявка не принята в обработку</text><!--MD5=[dbae1c89e38d79e152b64f2c999a8e64]
@startuml
title Диаграмма последовательности Psec
autonumber
actor "Сотрудник ИБ" as Foo
box "Mail Server"
participant "Почтовый ящик\nадминистратора сети" as Foo1
participant "Почтовый ящик\nPsec" as Foo2
end box
participant "Psec Server" as Foo3
participant "Log Server" as Foo4
participant "Коммутатор\nдоступа" as Foo5
actor "Системный\nадминистратор" as Foo6
Foo -> Foo1 : Сообщение с заявкой на\nподключение нового устройства
Foo1 -> Foo2 : Форвардинг сообщения\nс заявкой
loop Проверка на наличие входящих сообщений (два раза в минуту)
    Foo3 <-[#red]> Foo2 : POP3
alt Проверка сообщения
    Foo3 -> Foo3 : Создание дочернего процесса\nдля выполнение одной заявки
    note left
     Трек-идентификатор
     заявки содержит
     MAC-адрес устройства
    end note
    Foo3 <-[#red]> Foo2 : SMTP
    Foo2 ->> Foo1 : Заявка принята в обработку
    note left
     "<<MAC-адрес устройства>>
     принят в обработку"
     в теме сообщения
    end note
    == Выполнение одной заявки ==
    loop Запрос к БД лог-сервера (раз в минуту)
        Foo3 <-[#blue]> Foo4 : SSH подключение к лог-серверу,\nзапрос к БД Syslog (netmiko)
        note left
         Запрос содержит MAC-адрес
         нового подключаемого устройства
        end note
        hnote over Foo3, Foo4 : Ожидание подключения устройства
        ...
        Foo6 -> Foo5 : Подключение\nнового устройства
        Foo5 ->> Foo4 : Syslog сообщение
        note right
         Сообщение
         информационной безопастности
        end note
        Foo4 - -> Foo3 : Ответ от БД лог-сервера
        Foo3 -> Foo3 : Парсинг syslog сообщения
        note left
         Для дальнейшей настройки необходимы
         ip-адрес коммутатора доступа,
         порт к которому подключено новое устройство
        end note
        Foo3 <-[#blue]> Foo5 : SSH подключение к коммутатору доступа,\nвыполнение насторек (netmiko)
        Foo3 <-[#red]> Foo2 : SMTP
        alt #LightBlue Сообщение с результатом выполнения
            Foo2 ->> Foo1 : Заявка выполнена
            note right
             Статус выполнения заявки
             в теме сообщения,
             лог выполнения
             заявки в теле сообщения
            end note
        autonumber 14.1
        else #LightBlue Настройки выполнены ранее
            Foo2 ->> Foo1 : Заявка выполнена
        else #Pink Устройство в списке исключенных
            Foo2 ->> Foo1 : Заявка не выполнена
        else #Pink Попытка подключения устройства через Hub
            Foo2 ->> Foo1 : Заявка не выполнена
        else #Pink Порт доступа в состоянии shutdown
            Foo2 ->> Foo1 : Заявка не выполнена
        else #Pink Не удалось настроить
            Foo2 ->> Foo1 : Заявка не выполнена
        end
        autonumber 7.1
        break #Pink Окончание рабочего дня (после 18:00)
            Foo2 ->> Foo1 : Заявка не выполнена
            note right
             Устройство не было подключено
             в течение дня
            end note
        end
    end
autonumber 6.1
else #Pink Заявка поступила не от сотрудника ИБ
    Foo2 ->> Foo1 : Заявка не принята в обработку
else #Pink В теле письма отсутствует MAC-адрес (либо их слишком много)
    Foo2 ->> Foo1 : Заявка не принята в обработку
end
end
@enduml

PlantUML version 1.2021.00(Sun Jan 10 13:25:05 GMT+03:00 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1251
Language: ru
Country: RU
--></g></svg>