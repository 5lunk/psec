<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1523px" preserveAspectRatio="none" style="width:1167px;height:1523px;" version="1.1" viewBox="0 0 1167 1523" width="1167px" zoomAndPan="magnify"><defs><filter height="300%" id="f13d5wuxq11a2" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="192" x="484" y="30.6855">Psec sequence diagram</text><rect fill="#DDDDDD" height="1474.7813" style="stroke:#A80036;stroke-width:1.0;" width="320.5" x="173.5" y="42.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="73" x="297.25" y="56.1357">Mail Server</text><rect fill="#FFFFFF" filter="url(#f13d5wuxq11a2)" height="1192.5078" style="stroke:#000000;stroke-width:2.0;" width="1108" x="42" y="220.3047"/><rect fill="#FFFFFF" filter="url(#f13d5wuxq11a2)" height="1129.8047" style="stroke:#000000;stroke-width:2.0;" width="1088" x="52" y="276.0078"/><rect fill="#FFFFFF" filter="url(#f13d5wuxq11a2)" height="797.6172" style="stroke:#000000;stroke-width:2.0;" width="972.5" x="157.5" y="508.8203"/><rect fill="#ADD8E6" filter="url(#f13d5wuxq11a2)" height="305.9922" style="stroke:#000000;stroke-width:2.0;" width="606" x="167.5" y="920.7422"/><rect fill="#ADD8E6" height="46.1875" style="stroke:none;stroke-width:1.0;" width="606" x="167.5" y="995.7969"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="606" x="167.5" y="1041.9844"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="606" x="167.5" y="1088.1719"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="606" x="167.5" y="1134.3594"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="606" x="167.5" y="1180.5469"/><rect fill="#FFC0CB" filter="url(#f13d5wuxq11a2)" height="58.7031" style="stroke:#000000;stroke-width:2.0;" width="625" x="167.5" y="1240.7344"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="1088" x="52" y="1313.4375"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="1088" x="52" y="1359.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56" x2="56" y1="126.25" y2="618.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="56" x2="56" y1="618.2266" y2="646.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56" x2="56" y1="646.2266" y2="1429.8125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="232.5" y1="126.25" y2="618.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="232.5" x2="232.5" y1="618.2266" y2="646.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="232.5" y1="646.2266" y2="1429.8125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="457" x2="457" y1="126.25" y2="618.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="457" x2="457" y1="618.2266" y2="646.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="457" x2="457" y1="646.2266" y2="1429.8125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="547" x2="547" y1="126.25" y2="618.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="547" x2="547" y1="618.2266" y2="646.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="547" x2="547" y1="646.2266" y2="1429.8125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="776.5" x2="776.5" y1="126.25" y2="618.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="776.5" x2="776.5" y1="618.2266" y2="646.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="776.5" x2="776.5" y1="646.2266" y2="1429.8125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="908" x2="908" y1="126.25" y2="618.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="908" x2="908" y1="618.2266" y2="646.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="908" x2="908" y1="646.2266" y2="1429.8125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1086" x2="1086" y1="126.25" y2="618.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1086" x2="1086" y1="618.2266" y2="646.2266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1086" x2="1086" y1="646.2266" y2="1429.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="5" y="123.1738">Infsec engineer</text><ellipse cx="56.5" cy="51.6406" fill="#FEFECE" filter="url(#f13d5wuxq11a2)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M56.5,59.6406 L56.5,86.6406 M43.5,67.6406 L69.5,67.6406 M56.5,86.6406 L43.5,101.6406 M56.5,86.6406 L69.5,101.6406 " fill="none" filter="url(#f13d5wuxq11a2)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="5" y="1443.3457">Infsec engineer</text><ellipse cx="56.5" cy="1456.4219" fill="#FEFECE" filter="url(#f13d5wuxq11a2)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M56.5,1464.4219 L56.5,1491.4219 M43.5,1472.4219 L69.5,1472.4219 M56.5,1491.4219 L43.5,1506.4219 M56.5,1491.4219 L69.5,1506.4219 " fill="none" filter="url(#f13d5wuxq11a2)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f13d5wuxq11a2)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="106" x="177.5" y="72.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="184.5" y="93.5645">Network admin</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="207" y="111.1738">mailbox</text><rect fill="#FEFECE" filter="url(#f13d5wuxq11a2)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="106" x="177.5" y="1428.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="184.5" y="1450.3457">Network admin</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="207" y="1467.9551">mailbox</text><rect fill="#FEFECE" filter="url(#f13d5wuxq11a2)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="61" x="425" y="72.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="440" y="93.5645">Psec</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="432" y="111.1738">mailbox</text><rect fill="#FEFECE" filter="url(#f13d5wuxq11a2)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="61" x="425" y="1428.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="440" y="1450.3457">Psec</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="432" y="1467.9551">mailbox</text><rect fill="#FEFECE" filter="url(#f13d5wuxq11a2)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="91" x="500" y="89.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="507" y="111.1738">Psec Server</text><rect fill="#FEFECE" filter="url(#f13d5wuxq11a2)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="91" x="500" y="1428.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="507" y="1450.3457">Psec Server</text><rect fill="#FEFECE" filter="url(#f13d5wuxq11a2)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="84" x="732.5" y="89.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="739.5" y="111.1738">Log Server</text><rect fill="#FEFECE" filter="url(#f13d5wuxq11a2)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="84" x="732.5" y="1428.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="739.5" y="1450.3457">Log Server</text><rect fill="#FEFECE" filter="url(#f13d5wuxq11a2)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="103" x="855" y="89.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="862" y="111.1738">Access Switch</text><rect fill="#FEFECE" filter="url(#f13d5wuxq11a2)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="103" x="855" y="1428.8125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="862" y="1450.3457">Access Switch</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1053" y="123.1738">Sysadmin</text><ellipse cx="1086.5" cy="51.6406" fill="#FEFECE" filter="url(#f13d5wuxq11a2)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1086.5,59.6406 L1086.5,86.6406 M1073.5,67.6406 L1099.5,67.6406 M1086.5,86.6406 L1073.5,101.6406 M1086.5,86.6406 L1099.5,101.6406 " fill="none" filter="url(#f13d5wuxq11a2)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1053" y="1443.3457">Sysadmin</text><ellipse cx="1086.5" cy="1456.4219" fill="#FEFECE" filter="url(#f13d5wuxq11a2)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1086.5,1464.4219 L1086.5,1491.4219 M1073.5,1472.4219 L1099.5,1472.4219 M1086.5,1491.4219 L1073.5,1506.4219 M1086.5,1491.4219 L1099.5,1506.4219 " fill="none" filter="url(#f13d5wuxq11a2)" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="220.5,170.9531,230.5,174.9531,220.5,178.9531,224.5,174.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56.5" x2="226.5" y1="174.9531" y2="174.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="63.5" y="161.9209">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="74.5" y="153.7451">Message requesting</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="74.5" y="170.0967">a new device connection</text><polygon fill="#A80036" points="445.5,201.3047,455.5,205.3047,445.5,209.3047,449.5,205.3047" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="451.5" y1="205.3047" y2="205.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="239.5" y="200.4482">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="250.5" y="200.4482">Request message forwarding</text><path d="M42,220.3047 L115,220.3047 L115,228.3047 L105,238.3047 L42,238.3047 L42,220.3047 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="1192.5078" style="stroke:#000000;stroke-width:2.0;" width="1108" x="42" y="220.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="57" y="234.7998">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="270" x="130" y="233.7236">[Check for incoming messages (twice a minute)]</text><polygon fill="#FF0000" points="468.5,257.0078,458.5,261.0078,468.5,265.0078,464.5,261.0078" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="535.5,257.0078,545.5,261.0078,535.5,265.0078,539.5,261.0078" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="462.5" x2="541.5" y1="261.0078" y2="261.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="474.5" y="256.1514">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="485.5" y="256.1514">POP3</text><path d="M52,276.0078 L113,276.0078 L113,284.0078 L103,294.0078 L52,294.0078 L52,276.0078 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="1129.8047" style="stroke:#000000;stroke-width:2.0;" width="1088" x="52" y="276.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="67" y="290.5029">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="95" x="128" y="289.4268">[Message check]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="547.5" x2="589.5" y1="333.0625" y2="333.0625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="589.5" x2="589.5" y1="333.0625" y2="346.0625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="548.5" x2="589.5" y1="346.0625" y2="346.0625"/><polygon fill="#A80036" points="558.5,342.0625,548.5,346.0625,558.5,350.0625,554.5,346.0625" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="554.5" y="320.0303">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="565.5" y="311.8545">Creating a child process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="565.5" y="328.2061">to execute one request</text><path d="M340,300.8594 L340,342.8594 L538,342.8594 L538,310.8594 L528,300.8594 L340,300.8594 " fill="#FBFB77" filter="url(#f13d5wuxq11a2)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M528,300.8594 L528,310.8594 L538,310.8594 L528,300.8594 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="346" y="319.3545">Track ID contains</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="346" y="335.7061">the MAC address of the device</text><polygon fill="#FF0000" points="468.5,372.4141,458.5,376.4141,468.5,380.4141,464.5,376.4141" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="535.5,372.4141,545.5,376.4141,535.5,380.4141,539.5,376.4141" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="462.5" x2="541.5" y1="376.4141" y2="376.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="474.5" y="371.5576">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="485.5" y="371.5576">SMTP</text><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="428.1172" y2="424.1172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="428.1172" y2="432.1172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="456.5" y1="428.1172" y2="428.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="249.5" y="423.2607">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="260.5" y="423.2607">Request accepted for processing</text><path d="M62,389.4141 L62,448.4141 L223,448.4141 L223,399.4141 L213,389.4141 L62,389.4141 " fill="#FBFB77" filter="url(#f13d5wuxq11a2)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M213,389.4141 L213,399.4141 L223,399.4141 L213,389.4141 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="68" y="407.9092">"«Device MAC address»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="68" y="424.2607">request accepted"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="68" y="440.6123">in the message subject</text><rect fill="#EEEEEE" filter="url(#f13d5wuxq11a2)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1160" x="0" y="478.6445"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1160" y1="478.6445" y2="478.6445"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1160" y1="481.6445" y2="481.6445"/><rect fill="#EEEEEE" filter="url(#f13d5wuxq11a2)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="186" x="487" y="467.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="493" y="484.9639">Executing a single request</text><path d="M157.5,508.8203 L230.5,508.8203 L230.5,516.8203 L220.5,526.8203 L157.5,526.8203 L157.5,508.8203 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="797.6172" style="stroke:#000000;stroke-width:2.0;" width="972.5" x="157.5" y="508.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="172.5" y="523.3154">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="223" x="245.5" y="522.2393">[Log server DB query (once per minute)]</text><polygon fill="#0000FF" points="558.5,566.875,548.5,570.875,558.5,574.875,554.5,570.875" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="764.5,566.875,774.5,570.875,764.5,574.875,768.5,570.875" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="552.5" x2="770.5" y1="570.875" y2="570.875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="564.5" y="557.8428">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="575.5" y="549.667">SSH connection to the log server,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="575.5" y="566.0186">query to the Syslog DB (netmiko)</text><path d="M291,532.1719 L291,574.1719 L538,574.1719 L538,542.1719 L528,532.1719 L291,532.1719 " fill="#FBFB77" filter="url(#f13d5wuxq11a2)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M528,532.1719 L528,542.1719 L538,542.1719 L528,532.1719 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="297" y="550.667">The request contains the MAC address</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="297" y="567.0186">of the new connected device</text><polygon fill="#FBFB77" filter="url(#f13d5wuxq11a2)" points="514,588.875,809,588.875,819,600.875,809,612.875,514,612.875,504,600.875,514,588.875" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="577.25" y="606.3701">Waiting for device connection</text><polygon fill="#A80036" points="919.5,664.5781,909.5,668.5781,919.5,672.5781,915.5,668.5781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="913.5" x2="1085.5" y1="668.5781" y2="668.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="925.5" y="663.7217">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="936.5" y="663.7217">Connecting a new device</text><line style="stroke:#A80036;stroke-width:1.0;" x1="776.5" x2="786.5" y1="703.9297" y2="699.9297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="776.5" x2="786.5" y1="703.9297" y2="707.9297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="776.5" x2="907.5" y1="703.9297" y2="703.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="793.5" y="699.0732">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="804.5" y="699.0732">Syslog message</text><path d="M913,681.5781 L913,707.5781 L1104,707.5781 L1104,691.5781 L1094,681.5781 L913,681.5781 " fill="#FBFB77" filter="url(#f13d5wuxq11a2)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1094,681.5781 L1094,691.5781 L1104,691.5781 L1094,681.5781 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="919" y="700.0732">Information security message</text><polygon fill="#A80036" points="558.5,735.2813,548.5,739.2813,558.5,743.2813,554.5,739.2813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="552.5" x2="775.5" y1="739.2813" y2="739.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="564.5" y="734.4248">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="582.5" y="734.4248">Response from log server DB</text><line style="stroke:#A80036;stroke-width:1.0;" x1="547.5" x2="589.5" y1="792.6602" y2="792.6602"/><line style="stroke:#A80036;stroke-width:1.0;" x1="589.5" x2="589.5" y1="792.6602" y2="805.6602"/><line style="stroke:#A80036;stroke-width:1.0;" x1="548.5" x2="589.5" y1="805.6602" y2="805.6602"/><polygon fill="#A80036" points="558.5,801.6602,548.5,805.6602,558.5,809.6602,554.5,805.6602" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="554.5" y="787.8037">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="572.5" y="787.8037">Syslog message parsing</text><path d="M298,752.2813 L298,827.2813 L538,827.2813 L538,762.2813 L528,752.2813 L298,752.2813 " fill="#FBFB77" filter="url(#f13d5wuxq11a2)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M528,752.2813 L528,762.2813 L538,762.2813 L528,752.2813 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="304" y="770.7764">To configure the switch,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="304" y="787.1279">you need the IP address</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="304" y="803.4795">and access port number</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="304" y="819.8311">to which the new device is connected.</text><polygon fill="#0000FF" points="558.5,871.3906,548.5,875.3906,558.5,879.3906,554.5,875.3906" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="896.5,871.3906,906.5,875.3906,896.5,879.3906,900.5,875.3906" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="552.5" x2="902.5" y1="875.3906" y2="875.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="564.5" y="862.3584">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="582.5" y="854.1826">SSH connection to the access switch,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="582.5" y="870.5342">performing configuration (netmiko)</text><polygon fill="#FF0000" points="468.5,901.7422,458.5,905.7422,468.5,909.7422,464.5,905.7422" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="535.5,901.7422,545.5,905.7422,535.5,909.7422,539.5,905.7422" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="462.5" x2="541.5" y1="905.7422" y2="905.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="474.5" y="900.8857">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="492.5" y="900.8857">SMTP</text><path d="M167.5,920.7422 L228.5,920.7422 L228.5,928.7422 L218.5,938.7422 L167.5,938.7422 L167.5,920.7422 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="305.9922" style="stroke:#000000;stroke-width:2.0;" width="606" x="167.5" y="920.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="182.5" y="935.2373">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="152" x="243.5" y="934.1611">[Execution result message]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="974.6211" y2="970.6211"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="974.6211" y2="978.6211"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="456.5" y1="974.6211" y2="974.6211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="249.5" y="969.7646">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="267.5" y="969.7646">Task completed</text><path d="M462,944.0938 L462,986.0938 L754,986.0938 L754,954.0938 L744,944.0938 L462,944.0938 " fill="#FBFB77" filter="url(#f13d5wuxq11a2)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M744,944.0938 L744,954.0938 L754,954.0938 L744,944.0938 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271" x="468" y="962.5889">Task execution status in the message subject,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="468" y="978.9404">task execution log in the message body</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="167.5" x2="773.5" y1="996.7969" y2="996.7969"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="188" x="172.5" y="1008.2158">[Settings have been made before]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1033.9844" y2="1029.9844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1033.9844" y2="1037.9844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="456.5" y1="1033.9844" y2="1033.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="249.5" y="1029.1279">14.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="278.5" y="1029.1279">Task completed</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="167.5" x2="773.5" y1="1042.9844" y2="1042.9844"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="151" x="172.5" y="1054.4033">[Device in the excluded list]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1080.1719" y2="1076.1719"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1080.1719" y2="1084.1719"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="456.5" y1="1080.1719" y2="1080.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="249.5" y="1075.3154">14.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="278.5" y="1075.3154">Task failed</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="167.5" x2="773.5" y1="1089.1719" y2="1089.1719"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="113" x="172.5" y="1100.5908">[Connecting via hub]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1126.3594" y2="1122.3594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1126.3594" y2="1130.3594"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="456.5" y1="1126.3594" y2="1126.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="249.5" y="1121.5029">14.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="278.5" y="1121.5029">Task failed</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="167.5" x2="773.5" y1="1135.3594" y2="1135.3594"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="178" x="172.5" y="1146.7783">[Access port in shutdown state]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1172.5469" y2="1168.5469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1172.5469" y2="1176.5469"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="456.5" y1="1172.5469" y2="1172.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="249.5" y="1167.6904">14.4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="278.5" y="1167.6904">Task failed</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="167.5" x2="773.5" y1="1181.5469" y2="1181.5469"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="110" x="172.5" y="1192.9658">[Failed to configure]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1218.7344" y2="1214.7344"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1218.7344" y2="1222.7344"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="456.5" y1="1218.7344" y2="1218.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="249.5" y="1213.8779">14.5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="278.5" y="1213.8779">Task failed</text><path d="M167.5,1240.7344 L248.5,1240.7344 L248.5,1248.7344 L238.5,1258.7344 L167.5,1258.7344 L167.5,1240.7344 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="58.7031" style="stroke:#000000;stroke-width:2.0;" width="625" x="167.5" y="1240.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="182.5" y="1255.2295">break</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="201" x="263.5" y="1254.1533">[End of the working day (after 18:00)]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1286.4375" y2="1282.4375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1286.4375" y2="1290.4375"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="456.5" y1="1286.4375" y2="1286.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="249.5" y="1281.5811">7.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="271.5" y="1281.5811">Task failed</text><path d="M462,1264.0859 L462,1290.0859 L773,1290.0859 L773,1274.0859 L763,1264.0859 L462,1264.0859 " fill="#FBFB77" filter="url(#f13d5wuxq11a2)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M763,1264.0859 L763,1274.0859 L773,1274.0859 L763,1264.0859 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290" x="468" y="1282.5811">The device has not been connected during the day</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="52" x2="1140" y1="1314.4375" y2="1314.4375"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="312" x="57" y="1325.8564">[The Request was not received from an Infsec engineer]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1351.625" y2="1347.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1351.625" y2="1355.625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="456.5" y1="1351.625" y2="1351.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="249.5" y="1346.7686">6.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="271.5" y="1346.7686">Request not accepted</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="52" x2="1140" y1="1360.625" y2="1360.625"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="293" x="57" y="1372.0439">[There is no MAC address in the email (or too many)]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1397.8125" y2="1393.8125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="242.5" y1="1397.8125" y2="1401.8125"/><line style="stroke:#A80036;stroke-width:1.0;" x1="232.5" x2="456.5" y1="1397.8125" y2="1397.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="249.5" y="1392.9561">6.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="271.5" y="1392.9561">Request not accepted</text><!--MD5=[1507fa86b67c8282e18241a475f5722f]
@startuml
title Psec sequence diagram
autonumber
actor "Infsec engineer" as Foo
box "Mail Server"
participant "Network admin\nmailbox" as Foo1
participant "Psec\nmailbox" as Foo2
end box
participant "Psec Server" as Foo3
participant "Log Server" as Foo4
participant "Access Switch" as Foo5
actor "Sysadmin" as Foo6
Foo -> Foo1 : Message requesting\na new device connection
Foo1 -> Foo2 : Request message forwarding
loop Check for incoming messages (twice a minute)
    Foo3 <-[#red]> Foo2 : POP3
alt Message check
    Foo3 -> Foo3 : Creating a child process\nto execute one request
    note left
     Track ID contains
     the MAC address of the device
    end note
    Foo3 <-[#red]> Foo2 : SMTP
    Foo2 ->> Foo1 : Request accepted for processing
    note left
     "<<Device MAC address>>
     request accepted"
     in the message subject
    end note
    == Executing a single request ==
    loop Log server DB query (once per minute)
        Foo3 <-[#blue]> Foo4 : SSH connection to the log server,\nquery to the Syslog DB (netmiko)
        note left
         The request contains the MAC address
         of the new connected device
        end note
        hnote over Foo3, Foo4 : Waiting for device connection
        ...
        Foo6 -> Foo5 : Connecting a new device
        Foo5 ->> Foo4 : Syslog message
        note right
         Information security message
        end note
        Foo4 - -> Foo3 : Response from log server DB
        Foo3 -> Foo3 : Syslog message parsing
        note left
         To configure the switch,
         you need the IP address
         and access port number
         to which the new device is connected.
        end note
        Foo3 <-[#blue]> Foo5 : SSH connection to the access switch,\nperforming configuration (netmiko)
        Foo3 <-[#red]> Foo2 : SMTP
        alt #LightBlue Execution result message
            Foo2 ->> Foo1 : Task completed
            note right
             Task execution status in the message subject,
             task execution log in the message body
            end note
        autonumber 14.1
        else #LightBlue Settings have been made before
            Foo2 ->> Foo1 : Task completed
        else #Pink Device in the excluded list
            Foo2 ->> Foo1 : Task failed
        else #Pink Connecting via hub
            Foo2 ->> Foo1 : Task failed
        else #Pink Access port in shutdown state
            Foo2 ->> Foo1 : Task failed
        else #Pink Failed to configure
            Foo2 ->> Foo1 : Task failed
        end
        autonumber 7.1
        break #Pink End of the working day (after 18:00)
            Foo2 ->> Foo1 : Task failed
            note right
             The device has not been connected during the day
            end note
        end
    end
autonumber 6.1
else #Pink The Request was not received from an Infsec engineer
    Foo2 ->> Foo1 : Request not accepted
else #Pink There is no MAC address in the email (or too many)
    Foo2 ->> Foo1 : Request not accepted
end
end
@enduml

PlantUML version 1.2021.00(Sun Jan 10 13:25:05 GMT+03:00 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1251
Language: ru
Country: RU
--></g></svg>