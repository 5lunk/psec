<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1507px" preserveAspectRatio="none" style="width:1288px;height:1507px;" version="1.1" viewBox="0 0 1288 1507" width="1288px" zoomAndPan="magnify"><defs><filter height="300%" id="fw98817ydvcl9" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="192" x="544.5" y="30.6855">Psec sequence diagram</text><rect fill="#DDDDDD" height="1458.4297" style="stroke:#A80036;stroke-width:1.0;" width="320.5" x="294.5" y="42.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="73" x="418.25" y="56.1357">Mail Server</text><rect fill="#FFFFFF" filter="url(#fw98817ydvcl9)" height="1192.5078" style="stroke:#000000;stroke-width:2.0;" width="1108" x="163" y="203.9531"/><rect fill="#FFFFFF" filter="url(#fw98817ydvcl9)" height="1129.8047" style="stroke:#000000;stroke-width:2.0;" width="1088" x="173" y="259.6563"/><rect fill="#FFFFFF" filter="url(#fw98817ydvcl9)" height="797.6172" style="stroke:#000000;stroke-width:2.0;" width="972.5" x="278.5" y="492.4688"/><rect fill="#ADD8E6" filter="url(#fw98817ydvcl9)" height="305.9922" style="stroke:#000000;stroke-width:2.0;" width="606" x="288.5" y="904.3906"/><rect fill="#ADD8E6" height="46.1875" style="stroke:none;stroke-width:1.0;" width="606" x="288.5" y="979.4453"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="606" x="288.5" y="1025.6328"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="606" x="288.5" y="1071.8203"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="606" x="288.5" y="1118.0078"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="606" x="288.5" y="1164.1953"/><rect fill="#FFC0CB" filter="url(#fw98817ydvcl9)" height="58.7031" style="stroke:#000000;stroke-width:2.0;" width="625" x="288.5" y="1224.3828"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="1088" x="173" y="1297.0859"/><rect fill="#FFC0CB" height="46.1875" style="stroke:none;stroke-width:1.0;" width="1088" x="173" y="1343.2734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56" x2="56" y1="126.25" y2="601.875"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="56" x2="56" y1="601.875" y2="629.875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56" x2="56" y1="629.875" y2="1413.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="353.5" y1="126.25" y2="601.875"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="353.5" x2="353.5" y1="601.875" y2="629.875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="353.5" y1="629.875" y2="1413.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="578" x2="578" y1="126.25" y2="601.875"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="578" x2="578" y1="601.875" y2="629.875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="578" x2="578" y1="629.875" y2="1413.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="668" x2="668" y1="126.25" y2="601.875"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="668" x2="668" y1="601.875" y2="629.875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="668" x2="668" y1="629.875" y2="1413.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="897.5" x2="897.5" y1="126.25" y2="601.875"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="897.5" x2="897.5" y1="601.875" y2="629.875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="897.5" x2="897.5" y1="629.875" y2="1413.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1029" x2="1029" y1="126.25" y2="601.875"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1029" x2="1029" y1="601.875" y2="629.875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1029" x2="1029" y1="629.875" y2="1413.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1207" x2="1207" y1="126.25" y2="601.875"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1207" x2="1207" y1="601.875" y2="629.875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1207" x2="1207" y1="629.875" y2="1413.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="5" y="123.1738">Infsec engineer</text><ellipse cx="56.5" cy="51.6406" fill="#FEFECE" filter="url(#fw98817ydvcl9)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M56.5,59.6406 L56.5,86.6406 M43.5,67.6406 L69.5,67.6406 M56.5,86.6406 L43.5,101.6406 M56.5,86.6406 L69.5,101.6406 " fill="none" filter="url(#fw98817ydvcl9)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="5" y="1426.9941">Infsec engineer</text><ellipse cx="56.5" cy="1440.0703" fill="#FEFECE" filter="url(#fw98817ydvcl9)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M56.5,1448.0703 L56.5,1475.0703 M43.5,1456.0703 L69.5,1456.0703 M56.5,1475.0703 L43.5,1490.0703 M56.5,1475.0703 L69.5,1490.0703 " fill="none" filter="url(#fw98817ydvcl9)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#fw98817ydvcl9)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="106" x="298.5" y="72.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="305.5" y="93.5645">Network admin</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="328" y="111.1738">mailbox</text><rect fill="#FEFECE" filter="url(#fw98817ydvcl9)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="106" x="298.5" y="1412.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="305.5" y="1433.9941">Network admin</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="328" y="1451.6035">mailbox</text><rect fill="#FEFECE" filter="url(#fw98817ydvcl9)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="61" x="546" y="72.0313"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="561" y="93.5645">Psec</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="553" y="111.1738">mailbox</text><rect fill="#FEFECE" filter="url(#fw98817ydvcl9)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="61" x="546" y="1412.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="561" y="1433.9941">Psec</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47" x="553" y="1451.6035">mailbox</text><rect fill="#FEFECE" filter="url(#fw98817ydvcl9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="91" x="621" y="89.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="628" y="111.1738">Psec Server</text><rect fill="#FEFECE" filter="url(#fw98817ydvcl9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="91" x="621" y="1412.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="628" y="1433.9941">Psec Server</text><rect fill="#FEFECE" filter="url(#fw98817ydvcl9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="84" x="853.5" y="89.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="860.5" y="111.1738">Log Server</text><rect fill="#FEFECE" filter="url(#fw98817ydvcl9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="84" x="853.5" y="1412.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="860.5" y="1433.9941">Log Server</text><rect fill="#FEFECE" filter="url(#fw98817ydvcl9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="103" x="976" y="89.6406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="983" y="111.1738">Access Switch</text><rect fill="#FEFECE" filter="url(#fw98817ydvcl9)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="103" x="976" y="1412.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="983" y="1433.9941">Access Switch</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1174" y="123.1738">Sysadmin</text><ellipse cx="1207.5" cy="51.6406" fill="#FEFECE" filter="url(#fw98817ydvcl9)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1207.5,59.6406 L1207.5,86.6406 M1194.5,67.6406 L1220.5,67.6406 M1207.5,86.6406 L1194.5,101.6406 M1207.5,86.6406 L1220.5,101.6406 " fill="none" filter="url(#fw98817ydvcl9)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="1174" y="1426.9941">Sysadmin</text><ellipse cx="1207.5" cy="1440.0703" fill="#FEFECE" filter="url(#fw98817ydvcl9)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M1207.5,1448.0703 L1207.5,1475.0703 M1194.5,1456.0703 L1220.5,1456.0703 M1207.5,1475.0703 L1194.5,1490.0703 M1207.5,1475.0703 L1220.5,1490.0703 " fill="none" filter="url(#fw98817ydvcl9)" style="stroke:#A80036;stroke-width:2.0;"/><polygon fill="#A80036" points="341.5,154.6016,351.5,158.6016,341.5,162.6016,345.5,158.6016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="56.5" x2="347.5" y1="158.6016" y2="158.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="63.5" y="153.7451">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="74.5" y="153.7451">Message requesting a new device connection</text><polygon fill="#A80036" points="566.5,184.9531,576.5,188.9531,566.5,192.9531,570.5,188.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="572.5" y1="188.9531" y2="188.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="360.5" y="184.0967">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="371.5" y="184.0967">Request-message forwarding</text><path d="M163,203.9531 L236,203.9531 L236,211.9531 L226,221.9531 L163,221.9531 L163,203.9531 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="1192.5078" style="stroke:#000000;stroke-width:2.0;" width="1108" x="163" y="203.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="178" y="218.4482">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="270" x="251" y="217.3721">[Check for incoming messages (twice a minute)]</text><polygon fill="#FF0000" points="589.5,240.6563,579.5,244.6563,589.5,248.6563,585.5,244.6563" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="656.5,240.6563,666.5,244.6563,656.5,248.6563,660.5,244.6563" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="583.5" x2="662.5" y1="244.6563" y2="244.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="595.5" y="239.7998">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="606.5" y="239.7998">POP3</text><path d="M173,259.6563 L234,259.6563 L234,267.6563 L224,277.6563 L173,277.6563 L173,259.6563 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="1129.8047" style="stroke:#000000;stroke-width:2.0;" width="1088" x="173" y="259.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="188" y="274.1514">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="95" x="249" y="273.0752">[Message check]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="668.5" x2="710.5" y1="316.7109" y2="316.7109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="710.5" x2="710.5" y1="316.7109" y2="329.7109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="669.5" x2="710.5" y1="329.7109" y2="329.7109"/><polygon fill="#A80036" points="679.5,325.7109,669.5,329.7109,679.5,333.7109,675.5,329.7109" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="675.5" y="303.6787">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="686.5" y="295.5029">Creating a child process</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="686.5" y="311.8545">to execute one request</text><path d="M461,284.5078 L461,326.5078 L659,326.5078 L659,294.5078 L649,284.5078 L461,284.5078 " fill="#FBFB77" filter="url(#fw98817ydvcl9)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M649,284.5078 L649,294.5078 L659,294.5078 L649,284.5078 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="467" y="303.0029">Track ID contains</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="467" y="319.3545">the MAC address of the device</text><polygon fill="#FF0000" points="589.5,356.0625,579.5,360.0625,589.5,364.0625,585.5,360.0625" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="656.5,356.0625,666.5,360.0625,656.5,364.0625,660.5,360.0625" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="583.5" x2="662.5" y1="360.0625" y2="360.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="595.5" y="355.2061">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="606.5" y="355.2061">SMTP</text><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="411.7656" y2="407.7656"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="411.7656" y2="415.7656"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="577.5" y1="411.7656" y2="411.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="370.5" y="406.9092">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="381.5" y="406.9092">Request accepted for processing</text><path d="M183,373.0625 L183,432.0625 L344,432.0625 L344,383.0625 L334,373.0625 L183,373.0625 " fill="#FBFB77" filter="url(#fw98817ydvcl9)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M334,373.0625 L334,383.0625 L344,383.0625 L334,373.0625 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="189" y="391.5576">"«Device MAC address»</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="189" y="407.9092">request accepted"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="189" y="424.2607">in the message subject</text><rect fill="#EEEEEE" filter="url(#fw98817ydvcl9)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1281" x="0" y="462.293"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1281" y1="462.293" y2="462.293"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1281" y1="465.293" y2="465.293"/><rect fill="#EEEEEE" filter="url(#fw98817ydvcl9)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="186" x="547.5" y="451.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="168" x="553.5" y="468.6123">Executing a single request</text><path d="M278.5,492.4688 L351.5,492.4688 L351.5,500.4688 L341.5,510.4688 L278.5,510.4688 L278.5,492.4688 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="797.6172" style="stroke:#000000;stroke-width:2.0;" width="972.5" x="278.5" y="492.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="293.5" y="506.9639">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="223" x="366.5" y="505.8877">[Log server DB query (once per minute)]</text><polygon fill="#0000FF" points="679.5,550.5234,669.5,554.5234,679.5,558.5234,675.5,554.5234" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="885.5,550.5234,895.5,554.5234,885.5,558.5234,889.5,554.5234" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="673.5" x2="891.5" y1="554.5234" y2="554.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="685.5" y="541.4912">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194" x="696.5" y="533.3154">SSH connection to the log server,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="696.5" y="549.667">query to the Syslog DB (netmiko)</text><path d="M412,515.8203 L412,557.8203 L659,557.8203 L659,525.8203 L649,515.8203 L412,515.8203 " fill="#FBFB77" filter="url(#fw98817ydvcl9)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M649,515.8203 L649,525.8203 L659,525.8203 L649,515.8203 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226" x="418" y="534.3154">The request contains the MAC address</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="418" y="550.667">of the new connected device</text><polygon fill="#FBFB77" filter="url(#fw98817ydvcl9)" points="635,572.5234,930,572.5234,940,584.5234,930,596.5234,635,596.5234,625,584.5234,635,572.5234" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="698.25" y="590.0186">Waiting for device connection</text><polygon fill="#A80036" points="1040.5,648.2266,1030.5,652.2266,1040.5,656.2266,1036.5,652.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1034.5" x2="1206.5" y1="652.2266" y2="652.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="1046.5" y="647.3701">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="1057.5" y="647.3701">Connecting a new device</text><line style="stroke:#A80036;stroke-width:1.0;" x1="897.5" x2="907.5" y1="687.5781" y2="683.5781"/><line style="stroke:#A80036;stroke-width:1.0;" x1="897.5" x2="907.5" y1="687.5781" y2="691.5781"/><line style="stroke:#A80036;stroke-width:1.0;" x1="897.5" x2="1028.5" y1="687.5781" y2="687.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="7" x="914.5" y="682.7217">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="925.5" y="682.7217">Syslog message</text><path d="M1034,665.2266 L1034,691.2266 L1225,691.2266 L1225,675.2266 L1215,665.2266 L1034,665.2266 " fill="#FBFB77" filter="url(#fw98817ydvcl9)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1215,665.2266 L1215,675.2266 L1225,675.2266 L1215,665.2266 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="1040" y="683.7217">Information security message</text><polygon fill="#A80036" points="679.5,718.9297,669.5,722.9297,679.5,726.9297,675.5,722.9297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="673.5" x2="896.5" y1="722.9297" y2="722.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="685.5" y="718.0732">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="703.5" y="718.0732">Response from log server DB</text><line style="stroke:#A80036;stroke-width:1.0;" x1="668.5" x2="710.5" y1="776.3086" y2="776.3086"/><line style="stroke:#A80036;stroke-width:1.0;" x1="710.5" x2="710.5" y1="776.3086" y2="789.3086"/><line style="stroke:#A80036;stroke-width:1.0;" x1="669.5" x2="710.5" y1="789.3086" y2="789.3086"/><polygon fill="#A80036" points="679.5,785.3086,669.5,789.3086,679.5,793.3086,675.5,789.3086" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="675.5" y="771.4521">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="693.5" y="771.4521">Syslog message parsing</text><path d="M419,735.9297 L419,810.9297 L659,810.9297 L659,745.9297 L649,735.9297 L419,735.9297 " fill="#FBFB77" filter="url(#fw98817ydvcl9)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M649,735.9297 L649,745.9297 L659,745.9297 L649,735.9297 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="425" y="754.4248">To configure the switch,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="425" y="770.7764">you need the IP address</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="425" y="787.1279">and access port number</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219" x="425" y="803.4795">to which the new device is connected.</text><polygon fill="#0000FF" points="679.5,855.0391,669.5,859.0391,679.5,863.0391,675.5,859.0391" style="stroke:#0000FF;stroke-width:1.0;"/><polygon fill="#0000FF" points="1017.5,855.0391,1027.5,859.0391,1017.5,863.0391,1021.5,859.0391" style="stroke:#0000FF;stroke-width:1.0;"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="673.5" x2="1023.5" y1="859.0391" y2="859.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="685.5" y="846.0068">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="703.5" y="837.8311">SSH connection to the access switch,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="703.5" y="854.1826">performing configuration (netmiko)</text><polygon fill="#FF0000" points="589.5,885.3906,579.5,889.3906,589.5,893.3906,585.5,889.3906" style="stroke:#FF0000;stroke-width:1.0;"/><polygon fill="#FF0000" points="656.5,885.3906,666.5,889.3906,656.5,893.3906,660.5,889.3906" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="583.5" x2="662.5" y1="889.3906" y2="889.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="595.5" y="884.5342">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36" x="613.5" y="884.5342">SMTP</text><path d="M288.5,904.3906 L349.5,904.3906 L349.5,912.3906 L339.5,922.3906 L288.5,922.3906 L288.5,904.3906 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="305.9922" style="stroke:#000000;stroke-width:2.0;" width="606" x="288.5" y="904.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="303.5" y="918.8857">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="152" x="364.5" y="917.8096">[Execution result message]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="958.2695" y2="954.2695"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="958.2695" y2="962.2695"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="577.5" y1="958.2695" y2="958.2695"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="14" x="370.5" y="953.4131">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="388.5" y="953.4131">Task completed</text><path d="M583,927.7422 L583,969.7422 L875,969.7422 L875,937.7422 L865,927.7422 L583,927.7422 " fill="#FBFB77" filter="url(#fw98817ydvcl9)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M865,927.7422 L865,937.7422 L875,937.7422 L865,927.7422 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271" x="589" y="946.2373">Task execution status in the message subject,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="589" y="962.5889">task execution log in the message body</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="288.5" x2="894.5" y1="980.4453" y2="980.4453"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="188" x="293.5" y="991.8643">[Settings have been made before]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1017.6328" y2="1013.6328"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1017.6328" y2="1021.6328"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="577.5" y1="1017.6328" y2="1017.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="370.5" y="1012.7764">14.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="399.5" y="1012.7764">Task completed</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="288.5" x2="894.5" y1="1026.6328" y2="1026.6328"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="151" x="293.5" y="1038.0518">[Device in the excluded list]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1063.8203" y2="1059.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1063.8203" y2="1067.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="577.5" y1="1063.8203" y2="1063.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="370.5" y="1058.9639">14.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="399.5" y="1058.9639">Task failed</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="288.5" x2="894.5" y1="1072.8203" y2="1072.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="113" x="293.5" y="1084.2393">[Connecting via hub]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1110.0078" y2="1106.0078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1110.0078" y2="1114.0078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="577.5" y1="1110.0078" y2="1110.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="370.5" y="1105.1514">14.3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="399.5" y="1105.1514">Task failed</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="288.5" x2="894.5" y1="1119.0078" y2="1119.0078"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="178" x="293.5" y="1130.4268">[Access port in shutdown state]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1156.1953" y2="1152.1953"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1156.1953" y2="1160.1953"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="577.5" y1="1156.1953" y2="1156.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="370.5" y="1151.3389">14.4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="399.5" y="1151.3389">Task failed</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="288.5" x2="894.5" y1="1165.1953" y2="1165.1953"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="110" x="293.5" y="1176.6143">[Failed to configure]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1202.3828" y2="1198.3828"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1202.3828" y2="1206.3828"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="577.5" y1="1202.3828" y2="1202.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25" x="370.5" y="1197.5264">14.5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="399.5" y="1197.5264">Task failed</text><path d="M288.5,1224.3828 L369.5,1224.3828 L369.5,1232.3828 L359.5,1242.3828 L288.5,1242.3828 L288.5,1224.3828 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="58.7031" style="stroke:#000000;stroke-width:2.0;" width="625" x="288.5" y="1224.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="303.5" y="1238.8779">break</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="201" x="384.5" y="1237.8018">[End of the working day (after 18:00)]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1270.0859" y2="1266.0859"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1270.0859" y2="1274.0859"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="577.5" y1="1270.0859" y2="1270.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="370.5" y="1265.2295">7.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="392.5" y="1265.2295">Task failed</text><path d="M583,1247.7344 L583,1273.7344 L894,1273.7344 L894,1257.7344 L884,1247.7344 L583,1247.7344 " fill="#FBFB77" filter="url(#fw98817ydvcl9)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M884,1247.7344 L884,1257.7344 L894,1257.7344 L884,1247.7344 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290" x="589" y="1266.2295">The device has not been connected during the day</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="173" x2="1261" y1="1298.0859" y2="1298.0859"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="310" x="178" y="1309.5049">[The request was not received from an Infsec engineer]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1335.2734" y2="1331.2734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1335.2734" y2="1339.2734"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="577.5" y1="1335.2734" y2="1335.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="370.5" y="1330.417">6.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="392.5" y="1330.417">Request not accepted</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="173" x2="1261" y1="1344.2734" y2="1344.2734"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="293" x="178" y="1355.6924">[There is no MAC address in the email (or too many)]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1381.4609" y2="1377.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="363.5" y1="1381.4609" y2="1385.4609"/><line style="stroke:#A80036;stroke-width:1.0;" x1="353.5" x2="577.5" y1="1381.4609" y2="1381.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="370.5" y="1376.6045">6.2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="392.5" y="1376.6045">Request not accepted</text><!--MD5=[8aa4474e1497c4af956f9e1b179e6559]
@startuml
title Psec sequence diagram
autonumber
actor "Infsec engineer" as Foo
box "Mail Server"
participant "Network admin\nmailbox" as Foo1
participant "Psec\nmailbox" as Foo2
end box
participant "Psec Server" as Foo3
participant "Log Server" as Foo4
participant "Access Switch" as Foo5
actor "Sysadmin" as Foo6
Foo -> Foo1 : Message requesting a new device connection
Foo1 -> Foo2 : Request-message forwarding
loop Check for incoming messages (twice a minute)
    Foo3 <-[#red]> Foo2 : POP3
alt Message check
    Foo3 -> Foo3 : Creating a child process\nto execute one request
    note left
     Track ID contains
     the MAC address of the device
    end note
    Foo3 <-[#red]> Foo2 : SMTP
    Foo2 ->> Foo1 : Request accepted for processing
    note left
     "<<Device MAC address>>
     request accepted"
     in the message subject
    end note
    == Executing a single request ==
    loop Log server DB query (once per minute)
        Foo3 <-[#blue]> Foo4 : SSH connection to the log server,\nquery to the Syslog DB (netmiko)
        note left
         The request contains the MAC address
         of the new connected device
        end note
        hnote over Foo3, Foo4 : Waiting for device connection
        ...
        Foo6 -> Foo5 : Connecting a new device
        Foo5 ->> Foo4 : Syslog message
        note right
         Information security message
        end note
        Foo4 - -> Foo3 : Response from log server DB
        Foo3 -> Foo3 : Syslog message parsing
        note left
         To configure the switch,
         you need the IP address
         and access port number
         to which the new device is connected.
        end note
        Foo3 <-[#blue]> Foo5 : SSH connection to the access switch,\nperforming configuration (netmiko)
        Foo3 <-[#red]> Foo2 : SMTP
        alt #LightBlue Execution result message
            Foo2 ->> Foo1 : Task completed
            note right
             Task execution status in the message subject,
             task execution log in the message body
            end note
        autonumber 14.1
        else #LightBlue Settings have been made before
            Foo2 ->> Foo1 : Task completed
        else #Pink Device in the excluded list
            Foo2 ->> Foo1 : Task failed
        else #Pink Connecting via hub
            Foo2 ->> Foo1 : Task failed
        else #Pink Access port in shutdown state
            Foo2 ->> Foo1 : Task failed
        else #Pink Failed to configure
            Foo2 ->> Foo1 : Task failed
        end
        autonumber 7.1
        break #Pink End of the working day (after 18:00)
            Foo2 ->> Foo1 : Task failed
            note right
             The device has not been connected during the day
            end note
        end
    end
autonumber 6.1
else #Pink The request was not received from an Infsec engineer
    Foo2 ->> Foo1 : Request not accepted
else #Pink There is no MAC address in the email (or too many)
    Foo2 ->> Foo1 : Request not accepted
end
end
@enduml

PlantUML version 1.2021.00(Sun Jan 10 13:25:05 GMT+03:00 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1251
Language: ru
Country: RU
--></g></svg>